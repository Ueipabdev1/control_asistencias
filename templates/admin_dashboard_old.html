<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Administrativo - Control de Asistencias</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #e0e0e0;
        }
        
        .main-container {
            background: rgba(30, 30, 45, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            margin: 10px;
            max-width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: hidden;
        }
        
        @media (min-width: 1400px) {
            .main-container {
                margin: 20px auto;
                max-width: 1400px;
            }
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 15px;
            border-radius: 15px 15px 0 0;
            text-align: center;
        }
        
        @media (min-width: 768px) {
            .header {
                padding: 30px;
                border-radius: 20px 20px 0 0;
            }
        }
        
        .filters-section {
            background: rgba(40, 40, 60, 0.8);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            margin: 15px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (min-width: 768px) {
            .filters-section {
                margin: 30px;
                padding: 30px;
            }
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin: 15px;
        }
        
        @media (min-width: 768px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 25px;
                margin: 20px;
            }
        }
        
        @media (min-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 30px;
                margin: 30px;
            }
        }
        
        .chart-card {
            background: rgba(40, 40, 60, 0.8);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
            width: 100%;
            overflow: hidden;
        }
        
        @media (min-width: 768px) {
            .chart-card {
                padding: 25px;
            }
        }
        
        .chart-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
        }
        
        .chart-title {
            color: #ffffff;
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid rgba(102, 126, 234, 0.3);
            padding-bottom: 10px;
        }
        
        .form-control, .form-select {
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 10px 15px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: rgba(50, 50, 70, 0.8);
            color: #e0e0e0;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
            background: rgba(60, 60, 80, 0.9);
            color: #ffffff;
        }
        
        .form-control option, .form-select option {
            background: #2a2a40;
            color: #e0e0e0;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 25px;
            padding: 10px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stat-label {
            font-size: 1em;
            opacity: 0.9;
            color: #b0b0b0;
        }
        
        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
            min-height: 200px;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .spinner-border {
            color: #667eea;
            width: 3rem;
            height: 3rem;
        }
        
        .alert {
            border-radius: 15px;
            border: none;
            padding: 20px;
            margin: 20px 0;
        }
        
        .alert-info {
            background: rgba(13, 202, 240, 0.2);
            color: #17a2b8;
            border: 1px solid rgba(23, 162, 184, 0.3);
        }
        
        h3, h4, h5, h6 {
            color: #ffffff;
        }
        
        .form-label {
            color: #e0e0e0;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .period-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .period-tab {
            background: rgba(50, 50, 70, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #e0e0e0;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            outline: none;
        }
        
        .period-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
        
        .period-tab:hover {
            background: rgba(60, 60, 80, 0.8);
        }
        
        .period-tab:active {
            transform: scale(0.98);
        }
        
        .table-responsive {
            margin: 0 -15px;
            padding: 0 15px;
            border-radius: 10px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .table {
            min-width: 800px;
            margin-bottom: 1rem;
        }
        
        .table th, .table td {
            white-space: nowrap;
            padding: 0.75rem;
            vertical-align: middle;
        }
        
        @media (max-width: 767px) {
            .table th, .table td {
                padding: 0.5rem;
                font-size: 0.875rem;
            }
            
            .table .badge {
                font-size: 0.75rem;
                padding: 0.25em 0.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container-fluid p-0">
        <div class="main-container">
            <!-- Mobile Menu Toggle -->
            <div class="header">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h1 class="h3 mb-1"><i class="fas fa-chart-line"></i> Dashboard Administrativo</h1>
                        <p class="mb-0 small d-none d-md-block">Resumen de asistencias y estadísticas</p>
                    </div>
                    <div class="d-none d-md-block">
                        <div class="btn-group" role="group">
                            <a href="/dashboard" class="btn btn-outline-light" data-bs-toggle="tooltip" title="Dashboard">
                                <i class="fas fa-tachometer-alt"></i>
                            </a>
                            <a href="/gestion-matricula" class="btn btn-outline-light" data-bs-toggle="tooltip" title="Gestión de Matrícula">
                                <i class="fas fa-users"></i>
                            </a>
                            <a href="/gestion-profesores" class="btn btn-outline-light" data-bs-toggle="tooltip" title="Gestión de Profesores">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </a>
                            <a href="/logout" class="btn btn-outline-light" data-bs-toggle="tooltip" title="Cerrar Sesión">
                                <i class="fas fa-sign-out-alt"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="filters-section">
                <a href="/gestion-profesores" class="btn btn-outline-light">
                    <i class="fas fa-chalkboard-teacher"></i> Gestionar Profesores
                </a>
            </div>
            <div class="filters-section">
                <a href="/" class="btn btn-outline-light btn-lg">
                    <i class="fas fa-home"></i> Volver al Inicio
                </a>
            </div>
            
            <!-- Filtros de Fecha -->
            <div class="filters-section">
                <h4 class="text-center mb-4"><i class="fas fa-calendar-alt"></i> Filtros de Fecha</h4>
                <div class="row justify-content-center">
                    <div class="col-md-4">
                        <label class="form-label"><i class="fas fa-calendar-alt"></i> Fecha Inicio:</label>
                        <input type="date" id="fechaInicio" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label"><i class="fas fa-calendar-alt"></i> Fecha Fin:</label>
                        <input type="date" id="fechaFin" class="form-control">
                    </div>
                    <div class="col-md-4 d-flex align-items-end">
                        <button id="aplicarFiltroFecha" class="btn btn-primary w-100">
                            <i class="fas fa-search"></i> Filtrar por Fecha
                        </button>
                    </div>
                </div>
            </div>

            <!-- Pestañas de período -->
            <div class="text-center">
                <div class="period-tabs">
                    <button class="period-tab active" data-period="daily" type="button">
                        <i class="fas fa-calendar-day"></i> Diario
                    </button>
                    <button class="period-tab" data-period="weekly" type="button">
                        <i class="fas fa-calendar-week"></i> Semanal
                    </button>
                    <button class="period-tab" data-period="monthly" type="button">
                        <i class="fas fa-calendar-alt"></i> Mensual
                    </button>
                </div>
            </div>

            <!-- Estadísticas generales -->
            <div class="stats-overview" id="statsOverview">
                <div class="stat-card">
                    <div class="stat-number" id="totalAsistencia">85%</div>
                    <div class="stat-label"><i class="fas fa-percentage"></i> Asistencia Total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalEstudiantes">1,250</div>
                    <div class="stat-label"><i class="fas fa-users"></i> Total Estudiantes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalSecciones">24</div>
                    <div class="stat-label"><i class="fas fa-chalkboard-teacher"></i> Secciones</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="diasAnalizados">30</div>
                    <div class="stat-label"><i class="fas fa-calendar-check"></i> Días Analizados</div>
                </div>
            </div>

            <!-- Cuadro de Estadísticas Detalladas por Sección y Etapa -->
            <div class="filters-section">
                <h4 class="text-center mb-4"><i class="fas fa-chart-bar"></i> Estadísticas de Asistencia por Sección y Etapa</h4>
                
                <!-- Resumen por Etapas -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-white mb-3"><i class="fas fa-graduation-cap"></i> Resumen por Etapas</h5>
                        <div class="table-responsive">
                            <table class="table table-dark table-striped table-hover">
                                <thead class="table-primary">
                                    <tr>
                                        <th>Etapa</th>
                                        <th>Estudiantes</th>
                                        <th>Prom. Diario (H/M)</th>
                                        <th>Prom. Semanal (H/M)</th>
                                        <th>Prom. Mensual (H/M)</th>
                                        <th>% General</th>
                                        <th>Estado</th>
                                    </tr>
                                </thead>
                                <tbody id="etapasStatsTable">
                                    <!-- Se llenará dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Detalle por Secciones -->
                <div class="row">
                    <div class="col-12">
                        <h5 class="text-white mb-3"><i class="fas fa-chalkboard-teacher"></i> Asistencia por Secciones</h5>
                        <div class="table-responsive">
                            <table class="table table-dark table-striped table-hover">
                                <thead class="table-info">
                                    <tr>
                                        <th><i class="fas fa-chalkboard-teacher"></i> Sección</th>
                                        <th><i class="fas fa-graduation-cap"></i> Etapa</th>
                                        <th><i class="fas fa-users"></i> Total Matrícula</th>
                                        <th><i class="fas fa-calculator"></i> Cantidad Asistentes</th>
                                        <th><i class="fas fa-chart-line"></i> Promedio Diario</th>
                                        <th><i class="fas fa-percentage"></i> % Asistencia</th>
                                        <th><i class="fas fa-medal"></i> Estado</th>
                                    </tr>
                                </thead>
                                <tbody id="seccionesStatsTable">
                                    <!-- Se llenará dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Indicadores de Rendimiento -->
                <div class="row mt-4">
                    <div class="col-md-3">
                        <div class="stat-card text-center">
                            <div class="stat-number text-success" id="seccionesExcelentes">0</div>
                            <div class="stat-label"><i class="fas fa-star"></i> Secciones Excelentes (>90%)</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card text-center">
                            <div class="stat-number text-info" id="seccionesBuenas">0</div>
                            <div class="stat-label"><i class="fas fa-thumbs-up"></i> Secciones Buenas (80-90%)</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card text-center">
                            <div class="stat-number text-warning" id="seccionesRegulares">0</div>
                            <div class="stat-label"><i class="fas fa-exclamation-triangle"></i> Secciones Regulares (70-80%)</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card text-center">
                            <div class="stat-number text-danger" id="seccionesCriticas">0</div>
                            <div class="stat-label"><i class="fas fa-exclamation-circle"></i> Secciones Críticas (<70%)</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Loading -->
            <div id="loading" class="loading">
                <div class="spinner-border" role="status">
                    <span class="visually-hidden">Cargando datos...</span>
                </div>
                <p class="mt-3">Generando análisis de asistencia...</p>
            </div>

            <!-- Gráficos -->
            <div class="dashboard-grid" id="chartsContainer">
                <!-- Por Género -->
                <div class="chart-card">
                    <div class="chart-title">
                        <i class="fas fa-venus-mars"></i> Asistencia por Género
                    </div>
                    <div class="chart-container">
                        <canvas id="genderChart"></canvas>
                    </div>
                </div>

                <!-- Por Sección -->
                <div class="chart-card">
                    <div class="chart-title">
                        <i class="fas fa-chalkboard-teacher"></i> Asistencia por Sección
                    </div>
                    <div class="chart-container">
                        <canvas id="sectionChart"></canvas>
                    </div>
                </div>

                <!-- Por Etapa -->
                <div class="chart-card">
                    <div class="chart-title">
                        <i class="fas fa-graduation-cap"></i> Asistencia por Etapa
                    </div>
                    <div class="chart-container">
                        <canvas id="stageChart"></canvas>
                    </div>
                </div>

                <!-- Tendencia Temporal -->
                <div class="chart-card">
                    <div class="chart-title">
                        <i class="fas fa-chart-line"></i> Tendencia Temporal
                    </div>
                    <div class="chart-container">
                        <canvas id="timeChart"></canvas>
                    </div>
                </div>

                <!-- Comparativo Género por Etapa -->
                <div class="chart-card">
                    <div class="chart-title">
                        <i class="fas fa-balance-scale"></i> Género por Etapa
                    </div>
                    <div class="chart-container">
                        <canvas id="genderStageChart"></canvas>
                    </div>
                </div>

                <!-- Top/Bottom Secciones -->
                <div class="chart-card">
                    <div class="chart-title">
                        <i class="fas fa-trophy"></i> Ranking de Secciones
                    </div>
                    <div class="chart-container">
                        <canvas id="rankingChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Alertas -->
            <div id="alertas"></div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Initialize tooltips
        document.addEventListener('DOMContentLoaded', function() {
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
            
            // Make tables more touch-friendly on mobile
            document.querySelectorAll('.table-responsive').forEach(function(table) {
                let isDown = false;
                let startX;
                let scrollLeft;
                
                table.addEventListener('mousedown', (e) => {
                    isDown = true;
                    startX = e.pageX - table.offsetLeft;
                    scrollLeft = table.scrollLeft;
                    table.style.cursor = 'grabbing';
                });
                
                table.addEventListener('mouseleave', () => {
                    isDown = false;
                    table.style.cursor = 'grab';
                });
                
                table.addEventListener('mouseup', () => {
                    isDown = false;
                    table.style.cursor = 'grab';
                });
                
                table.addEventListener('mousemove', (e) => {
                    if(!isDown) return;
                    e.preventDefault();
                    const x = e.pageX - table.offsetLeft;
                    const walk = (x - startX) * 2; // Adjust scroll speed
                    table.scrollLeft = scrollLeft - walk;
                });
                
                // Prevent scrolling the page when swiping on the table
                table.addEventListener('touchmove', (e) => {
                    if (table.scrollWidth > table.clientWidth) {
                        e.preventDefault();
                    }
                }, { passive: false });
            });
        });
    </script>
    <script>
        let charts = {};
        let currentPeriod = 'daily';

        $(document).ready(function() {
            // Configurar fechas por defecto
            const hoy = new Date();
            const hace30dias = new Date(hoy.getTime() - (30 * 24 * 60 * 60 * 1000));
            
            $('#fechaFin').val(hoy.toISOString().split('T')[0]);
            $('#fechaInicio').val(hace30dias.toISOString().split('T')[0]);
            
            // Cargar datos iniciales
            generarDatosPorPeriodo('daily');
            crearGraficos();
            
            // Event listeners para pestañas de período
            $(document).on('click', '.period-tab', function() {
                console.log('Period tab clicked:', $(this).data('period'));
                
                $('.period-tab').removeClass('active');
                $(this).addClass('active');
                
                const periodo = $(this).data('period');
                currentPeriod = periodo;
                
                mostrarAlerta(`Mostrando datos ${periodo === 'daily' ? 'diarios' : periodo === 'weekly' ? 'semanales' : 'mensuales'}`, 'info');
                
                // Actualizar datos según el período seleccionado
                setTimeout(() => {
                    generarDatosPorPeriodo(periodo);
                    crearGraficos();
                }, 500);
            });
            
            
            // Event listener para filtro por fecha
            $('#aplicarFiltroFecha').click(function() {
                const fechaInicio = $('#fechaInicio').val();
                const fechaFin = $('#fechaFin').val();
                
                if (!fechaInicio || !fechaFin) {
                    mostrarAlerta('Por favor selecciona ambas fechas', 'warning');
                    return;
                }
                
                if (new Date(fechaInicio) > new Date(fechaFin)) {
                    mostrarAlerta('La fecha de inicio no puede ser mayor que la fecha fin', 'warning');
                    return;
                }
                
                mostrarAlerta('Filtrando datos por rango de fechas...', 'info');
                
                setTimeout(() => {
                    generarDatosPorFecha(fechaInicio, fechaFin);
                    mostrarAlerta('Datos filtrados correctamente', 'success');
                }, 1000);
            });
            
            // Event listener para actualizar datos
            $('#actualizarDatos').click(function() {
                mostrarAlerta('Actualizando datos...', 'info');
                
                setTimeout(() => {
                    aplicarFiltros();
                    mostrarAlerta('Datos actualizados correctamente', 'success');
                }, 1000);
            });
            
            // Event listener para limpiar filtros
            $('#limpiarFiltros').click(function() {
                $('#fechaInicio').val(hace30dias.toISOString().split('T')[0]);
                $('#fechaFin').val(hoy.toISOString().split('T')[0]);
                $('#etapa').val('');
                $('#seccionFiltro').val('');
                $('#rendimientoMinimo').val('0');
                
                cargarOpcionesSecciones();
                generarDatosMock();
                actualizarGraficos();
                mostrarAlerta('Filtros limpiados', 'info');
            });
        });

        function generarDatosPorFecha(fechaInicio, fechaFin) {
            // Calcular días entre fechas
            const inicio = new Date(fechaInicio);
            const fin = new Date(fechaFin);
            const diasDiferencia = Math.ceil((fin - inicio) / (1000 * 60 * 60 * 24));
            
            // Configurar datos según el rango de fechas
            let rangoAsistencia, variabilidad;
            if (diasDiferencia <= 7) {
                rangoAsistencia = [75, 95];
                variabilidad = 20;
            } else if (diasDiferencia <= 30) {
                rangoAsistencia = [80, 92];
                variabilidad = 15;
            } else {
                rangoAsistencia = [82, 90];
                variabilidad = 10;
            }
            
            // Actualizar estadísticas generales
            const baseAsistencia = rangoAsistencia[0] + Math.random() * (rangoAsistencia[1] - rangoAsistencia[0]);
            $('#totalAsistencia').text(Math.floor(baseAsistencia) + '%');
            $('#totalEstudiantes').text((Math.floor(Math.random() * 500 + 1000)).toLocaleString());
            $('#totalSecciones').text(Math.floor(Math.random() * 10 + 20));
            $('#diasAnalizados').text(diasDiferencia);
            
            // Generar datos para las tablas
            generarTablaEtapasPorFecha(fechaInicio, fechaFin, rangoAsistencia, variabilidad);
            generarTablaSeccionesPorFecha(fechaInicio, fechaFin, rangoAsistencia, variabilidad);
            actualizarIndicadoresRendimiento();
        }
        
        function generarDatosMock() {
            
            // Actualizar estadísticas generales
            $('#totalAsistencia').text(Math.floor(Math.random() * 15 + 80) + '%');
            $('#totalEstudiantes').text((Math.floor(Math.random() * 500 + 1000)).toLocaleString());
            $('#totalSecciones').text(Math.floor(Math.random() * 10 + 20));
            $('#diasAnalizados').text(Math.floor(Math.random() * 20 + 20));
            
            // Generar datos para las tablas de estadísticas
            generarTablaEtapas();
            generarTablaSecciones();
            actualizarIndicadoresRendimiento();
        }

        function generarDatosPorPeriodo(periodo) {
            // Configuración de períodos
            const configuracionPeriodos = {
                daily: { 
                    label: 'Últimos 7 días', 
                    multiplicador: 1,
                    rangoAsistencia: [75, 95],
                    variabilidad: 20
                },
                weekly: { 
                    label: 'Últimas 4 semanas', 
                    multiplicador: 7,
                    rangoAsistencia: [80, 92],
                    variabilidad: 15
                },
                monthly: { 
                    label: 'Últimos 6 meses', 
                    multiplicador: 30,
                    rangoAsistencia: [82, 90],
                    variabilidad: 10
                }
            };
            
            const config = configuracionPeriodos[periodo] || configuracionPeriodos.daily;
            
            // Actualizar estadísticas generales según el período
            const baseAsistencia = config.rangoAsistencia[0] + Math.random() * (config.rangoAsistencia[1] - config.rangoAsistencia[0]);
            $('#totalAsistencia').text(Math.floor(baseAsistencia) + '%');
            $('#totalEstudiantes').text((Math.floor(Math.random() * 500 + 1000)).toLocaleString());
            $('#totalSecciones').text(Math.floor(Math.random() * 10 + 20));
            
            // Calcular días analizados según el período
            let diasAnalizados;
            switch(periodo) {
                case 'daily': diasAnalizados = 7; break;
                case 'weekly': diasAnalizados = 28; break;
                case 'monthly': diasAnalizados = 180; break;
                default: diasAnalizados = 30;
            }
            $('#diasAnalizados').text(diasAnalizados);
            
            // Generar datos para las tablas con variación según período
            generarTablaEtapasPorPeriodo(periodo, config);
            generarTablaSeccionesPorPeriodo(periodo, config);
            actualizarIndicadoresRendimiento();
        }

        function generarTablaEtapasPorPeriodo(periodo, config) {
            const etapas = [
                { nombre: 'Maternal', estudiantes: Math.floor(Math.random() * 200 + 150) },
                { nombre: 'Primaria', estudiantes: Math.floor(Math.random() * 400 + 300) },
                { nombre: 'Secundaria', estudiantes: Math.floor(Math.random() * 350 + 250) }
            ];
            
            let html = '';
            etapas.forEach(etapa => {
                // Generar porcentajes según el período con diferentes características
                let promDiario, promSemanal, promMensual;
                
                if (periodo === 'daily') {
                    promDiario = Math.floor(Math.random() * config.variabilidad + config.rangoAsistencia[0]);
                    promSemanal = Math.floor(promDiario + Math.random() * 5 - 2);
                    promMensual = Math.floor(promSemanal + Math.random() * 3 - 1);
                } else if (periodo === 'weekly') {
                    promSemanal = Math.floor(Math.random() * config.variabilidad + config.rangoAsistencia[0]);
                    promDiario = Math.floor(promSemanal + Math.random() * 8 - 4);
                    promMensual = Math.floor(promSemanal + Math.random() * 4 - 2);
                } else { // monthly
                    promMensual = Math.floor(Math.random() * config.variabilidad + config.rangoAsistencia[0]);
                    promSemanal = Math.floor(promMensual + Math.random() * 6 - 3);
                    promDiario = Math.floor(promSemanal + Math.random() * 8 - 4);
                }
                
                // Asegurar que estén en rangos válidos
                promDiario = Math.max(60, Math.min(100, promDiario));
                promSemanal = Math.max(60, Math.min(100, promSemanal));
                promMensual = Math.max(60, Math.min(100, promMensual));
                
                const porcentajeGeneral = Math.floor((promDiario + promSemanal + promMensual) / 3);
                
                const badgeClass = porcentajeGeneral >= 90 ? 'bg-success' : 
                                 porcentajeGeneral >= 80 ? 'bg-info' : 
                                 porcentajeGeneral >= 70 ? 'bg-warning' : 'bg-danger';
                
                html += `
                    <tr>
                        <td><strong>${etapa.nombre}</strong></td>
                        <td>${etapa.estudiantes.toLocaleString()}</td>
                        <td>${promDiario}%</td>
                        <td>${promSemanal}%</td>
                        <td>${promMensual}%</td>
                        <td><span class="badge ${badgeClass}">${porcentajeGeneral}%</span></td>
                    </tr>
                `;
            });
            
            $('#etapasStatsTable').html(html);
        }

        function generarTablaSeccionesPorPeriodo(periodo, config) {
            const secciones = [
                { nombre: 'Nivel 1 maternal', etapa: 'Maternal' },
                { nombre: 'Nivel 2 maternal', etapa: 'Maternal' },
                { nombre: 'Nivel 3 maternal', etapa: 'Maternal' },
                { nombre: '1er grado primaria', etapa: 'Primaria' },
                { nombre: '2do grado primaria', etapa: 'Primaria' },
                { nombre: '3er grado primaria', etapa: 'Primaria' },
                { nombre: '4to grado primaria', etapa: 'Primaria' },
                { nombre: '5to grado primaria', etapa: 'Primaria' },
                { nombre: '6to grado primaria', etapa: 'Primaria' },
                { nombre: '1er año secundaria', etapa: 'Secundaria' },
                { nombre: '2do año secundaria', etapa: 'Secundaria' },
                { nombre: '3er año A secundaria', etapa: 'Secundaria' },
                { nombre: '3er año B secundaria', etapa: 'Secundaria' },
                { nombre: '4to año secundaria', etapa: 'Secundaria' },
                { nombre: '5to año secundaria', etapa: 'Secundaria' }
            ];
            
            let html = '';
            secciones.forEach(seccion => {
                // Generar datos de matrícula por género (aproximadamente 50/50)
                const totalMatriculaH = Math.floor(Math.random() * 12 + 10); // 10-22
                const totalMatriculaM = Math.floor(Math.random() * 12 + 10); // 10-22
                const totalMatricula = totalMatriculaH + totalMatriculaM;
                
                // Calcular asistencia basada en el período por género
                let factorPeriodoH, factorPeriodoM;
                
                // Base factors with slight variation between genders
                const baseFactor = {
                    'daily': 0.7 + Math.random() * 0.25,
                    'weekly': 0.75 + Math.random() * 0.2,
                    'monthly': 0.8 + Math.random() * 0.15
                }[periodo] || 0.75;
                
                // Slightly randomize factors for each gender
                factorPeriodoH = Math.max(0.6, Math.min(0.95, baseFactor + (Math.random() * 0.1 - 0.05)));
                factorPeriodoM = Math.max(0.6, Math.min(0.95, baseFactor + (Math.random() * 0.1 - 0.05)));
                
                // Calculate attendance by gender
                const asistentesH = Math.floor(totalMatriculaH * factorPeriodoH);
                const asistentesM = Math.floor(totalMatriculaM * factorPeriodoM);
                const totalAsistentes = asistentesH + asistentesM;
                
                // Calculate daily averages by gender
                const promedioDiarioH = Math.floor(Math.random() * config.variabilidad + config.rangoAsistencia[0]);
                const promedioDiarioM = Math.floor(Math.random() * config.variabilidad + config.rangoAsistencia[0]);
                
                // Calculate attendance percentage by gender
                const porcentajeAsistenciaH = totalMatriculaH > 0 ? Math.floor((asistentesH / totalMatriculaH) * 100) : 0;
                const porcentajeAsistenciaM = totalMatriculaM > 0 ? Math.floor((asistentesM / totalMatriculaM) * 100) : 0;
                const porcentajeAsistenciaTotal = Math.floor((totalAsistentes / totalMatricula) * 100);
                
                // Determine status based on total attendance percentage
                let estado, badgeClass;
                if (porcentajeAsistenciaTotal >= 90) {
                    estado = 'Excelente';
                    badgeClass = 'bg-success';
                } else if (porcentajeAsistenciaTotal >= 80) {
                    estado = 'Bueno';
                    badgeClass = 'bg-info';
                } else if (porcentajeAsistenciaTotal >= 70) {
                    estado = 'Regular';
                    badgeClass = 'bg-warning';
                } else {
                    estado = 'Crítico';
                    badgeClass = 'bg-danger';
                }
                
                html += `
                    <tr>
                        <td><strong>${seccion.nombre}</strong></td>
                        <td><span class="badge bg-secondary">${seccion.etapa}</span></td>
                        <td><strong>${totalMatricula}</strong><br><small class="text-muted">H: ${totalMatriculaH} / M: ${totalMatriculaM}</small></td>
                        
                        <!-- Asistencia por género -->
                        <td class="text-center"><span class="text-info">${asistentesH}</span></td>
                        <td class="text-center"><span class="text-info">${asistentesM}</span></td>
                        
                        <!-- Promedio diario por género -->
                        <td class="text-center"><span class="text-warning">${promedioDiarioH}%</span></td>
                        <td class="text-center"><span class="text-warning">${promedioDiarioM}%</span></td>
                        
                        <!-- Porcentaje de asistencia por género -->
                        <td class="text-center"><span class="badge ${porcentajeAsistenciaH >= 90 ? 'bg-success' : porcentajeAsistenciaH >= 80 ? 'bg-info' : porcentajeAsistenciaH >= 70 ? 'bg-warning' : 'bg-danger'}">${porcentajeAsistenciaH}%</span></td>
                        <td class="text-center"><span class="badge ${porcentajeAsistenciaM >= 90 ? 'bg-success' : porcentajeAsistenciaM >= 80 ? 'bg-info' : porcentajeAsistenciaM >= 70 ? 'bg-warning' : 'bg-danger'}">${porcentajeAsistenciaM}%</span></td>
                        
                        <!-- Estado general -->
                        <td><span class="badge ${badgeClass}">${estado}</span></td>
                    </tr>
                `;
            });
            
            $('#seccionesStatsTable').html(html);
        }

        function generarTablaEtapas() {
            const etapas = [
                { 
                    nombre: 'Maternal', 
                    estudiantesH: Math.floor(Math.random() * 100 + 75),
                    estudiantesM: Math.floor(Math.random() * 100 + 75),
                    promDiarioH: Math.floor(Math.random() * 15 + 80),
                    promDiarioM: Math.floor(Math.random() * 15 + 80),
                    promSemanalH: Math.floor(Math.random() * 10 + 85),
                    promSemanalM: Math.floor(Math.random() * 10 + 85),
                    promMensualH: Math.floor(Math.random() * 8 + 87),
                    promMensualM: Math.floor(Math.random() * 8 + 87)
                },
                { 
                    nombre: 'Primaria', 
                    estudiantesH: Math.floor(Math.random() * 200 + 150),
                    estudiantesM: Math.floor(Math.random() * 200 + 150),
                    promDiarioH: Math.floor(Math.random() * 12 + 82),
                    promDiarioM: Math.floor(Math.random() * 12 + 82),
                    promSemanalH: Math.floor(Math.random() * 8 + 87),
                    promSemanalM: Math.floor(Math.random() * 8 + 87),
                    promMensualH: Math.floor(Math.random() * 6 + 89),
                    promMensualM: Math.floor(Math.random() * 6 + 89)
                },
                { 
                    nombre: 'Secundaria', 
                    estudiantesH: Math.floor(Math.random() * 175 + 125),
                    estudiantesM: Math.floor(Math.random() * 175 + 125),
                    promDiarioH: Math.floor(Math.random() * 10 + 85),
                    promDiarioM: Math.floor(Math.random() * 10 + 85),
                    promSemanalH: Math.floor(Math.random() * 6 + 89),
                    promSemanalM: Math.floor(Math.random() * 6 + 89),
                    promMensualH: Math.floor(Math.random() * 4 + 91),
                    promMensualM: Math.floor(Math.random() * 4 + 91)
                }
            ];
            
            let html = '';
            etapas.forEach(etapa => {
                const totalEstudiantes = etapa.estudiantesH + etapa.estudiantesM;
                const promDiarioTotal = Math.floor((etapa.promDiarioH + etapa.promDiarioM) / 2);
                const promSemanalTotal = Math.floor((etapa.promSemanalH + etapa.promSemanalM) / 2);
                const promMensualTotal = Math.floor((etapa.promMensualH + etapa.promMensualM) / 2);
                const porcentajeGeneral = Math.floor((promDiarioTotal + promSemanalTotal + promMensualTotal) / 3);
                
                const badgeClass = porcentajeGeneral >= 90 ? 'bg-success' : 
                                 porcentajeGeneral >= 80 ? 'bg-info' : 
                                 porcentajeGeneral >= 70 ? 'bg-warning' : 'bg-danger';
                
                html += `
                    <tr>
                        <td><strong>${etapa.nombre}</strong></td>
                        <td>${totalEstudiantes.toLocaleString()}<br><small class="text-muted">H: ${etapa.estudiantesH} / M: ${etapa.estudiantesM}</small></td>
                        <td>${etapa.promDiarioH}% / ${etapa.promDiarioM}%</td>
                        <td>${etapa.promSemanalH}% / ${etapa.promSemanalM}%</td>
                        <td>${etapa.promMensualH}% / ${etapa.promMensualM}%</td>
                        <td><span class="badge ${badgeClass}">${porcentajeGeneral}%</span></td>
                    </tr>
                `;
            });
            
            $('#etapasStatsTable').html(html);
        }

        function generarTablaSecciones() {
            const secciones = [
                { nombre: 'Nivel 1 maternal', etapa: 'Maternal' },
                { nombre: 'Nivel 2 maternal', etapa: 'Maternal' },
                { nombre: 'Nivel 3 maternal', etapa: 'Maternal' },
                { nombre: '1er grado primaria', etapa: 'Primaria' },
                { nombre: '2do grado primaria', etapa: 'Primaria' },
                { nombre: '3er grado primaria', etapa: 'Primaria' },
                { nombre: '4to grado primaria', etapa: 'Primaria' },
                { nombre: '5to grado primaria', etapa: 'Primaria' },
                { nombre: '6to grado primaria', etapa: 'Primaria' },
                { nombre: '1er año secundaria', etapa: 'Secundaria' },
                { nombre: '2do año secundaria', etapa: 'Secundaria' },
                { nombre: '3er año A secundaria', etapa: 'Secundaria' },
                { nombre: '3er año B secundaria', etapa: 'Secundaria' },
                { nombre: '4to año secundaria', etapa: 'Secundaria' },
                { nombre: '5to año secundaria', etapa: 'Secundaria' }
            ];
            
            let html = '';
            secciones.forEach(seccion => {
                const totalMatricula = Math.floor(Math.random() * 25 + 20);
                const cantidadAsistentes = Math.floor(totalMatricula * (Math.random() * 0.3 + 0.7)); // 70-100% del total
                const promedioDiario = Math.floor(Math.random() * 15 + 80);
                const porcentajeAsistencia = Math.floor((cantidadAsistentes / totalMatricula) * 100);
                
                let estado, badgeClass;
                if (porcentajeAsistencia >= 90) {
                    estado = 'Excelente';
                    badgeClass = 'bg-success';
                } else if (porcentajeAsistencia >= 80) {
                    estado = 'Bueno';
                    badgeClass = 'bg-info';
                } else if (porcentajeAsistencia >= 70) {
                    estado = 'Regular';
                    badgeClass = 'bg-warning';
                } else {
                    estado = 'Crítico';
                    badgeClass = 'bg-danger';
                }
                
                html += `
                    <tr>
                        <td><strong>${seccion.nombre}</strong></td>
                        <td><span class="badge bg-secondary">${seccion.etapa}</span></td>
                        <td><strong>${totalMatricula}</strong><br><small class="text-muted">H: ${totalMatriculaH} / M: ${totalMatriculaM}</small></td>
                        
                        <!-- Asistencia por género -->
                        <td class="text-center"><span class="text-info">${asistentesH}</span></td>
                        <td class="text-center"><span class="text-info">${asistentesM}</span></td>
                        
                        <!-- Promedio diario por género -->
                        <td class="text-center"><span class="text-warning">${promedioDiarioH}%</span></td>
                        <td class="text-center"><span class="text-warning">${promedioDiarioM}%</span></td>
                        
                        <!-- Porcentaje de asistencia por género -->
                        <td class="text-center"><span class="badge ${porcentajeAsistenciaH >= 90 ? 'bg-success' : porcentajeAsistenciaH >= 80 ? 'bg-info' : porcentajeAsistenciaH >= 70 ? 'bg-warning' : 'bg-danger'}">${porcentajeAsistenciaH}%</span></td>
                        <td class="text-center"><span class="badge ${porcentajeAsistenciaM >= 90 ? 'bg-success' : porcentajeAsistenciaM >= 80 ? 'bg-info' : porcentajeAsistenciaM >= 70 ? 'bg-warning' : 'bg-danger'}">${porcentajeAsistenciaM}%</span></td>
                        
                        <!-- Estado general -->
                        <td><span class="badge ${badgeClass}">${estado}</span></td>
                    </tr>
                `;
            });
            
            $('#seccionesStatsTable').html(html);
        }

        function generarTablaEtapasPorFecha(fechaInicio, fechaFin, rangoAsistencia, variabilidad) {
            const etapas = [
                { nombre: 'Maternal', estudiantes: Math.floor(Math.random() * 200 + 150) },
                { nombre: 'Primaria', estudiantes: Math.floor(Math.random() * 400 + 300) },
                { nombre: 'Secundaria', estudiantes: Math.floor(Math.random() * 300 + 250) }
            ];
            
            let html = '';
            etapas.forEach(etapa => {
                const baseAsistencia = rangoAsistencia[0] + Math.random() * (rangoAsistencia[1] - rangoAsistencia[0]);
                const asistencia = Math.max(50, Math.min(100, baseAsistencia + (Math.random() - 0.5) * variabilidad));
                const asistentes = Math.floor((asistencia / 100) * etapa.estudiantes);
                
                let badgeClass = 'success';
                if (asistencia < 70) badgeClass = 'danger';
                else if (asistencia < 80) badgeClass = 'warning';
                else if (asistencia < 90) badgeClass = 'info';
                
                html += `
                    <tr>
                        <td><strong>${etapa.nombre}</strong></td>
                        <td>${etapa.estudiantes.toLocaleString()}</td>
                        <td>${asistentes.toLocaleString()}</td>
                        <td>${Math.floor(asistentes / Math.ceil((new Date(fechaFin) - new Date(fechaInicio)) / (1000 * 60 * 60 * 24)))}</td>
                        <td><span class="badge bg-${badgeClass}">${asistencia.toFixed(1)}%</span></td>
                    </tr>
                `;
            });
            
            $('#etapasStatsTable').html(html);
        }

        function generarTablaSeccionesPorFecha(fechaInicio, fechaFin, rangoAsistencia, variabilidad) {
            const secciones = [
                { nombre: 'Nivel 1 maternal', etapa: 'Maternal' },
                { nombre: 'Nivel 2 maternal', etapa: 'Maternal' },
                { nombre: '1er grado primaria', etapa: 'Primaria' },
                { nombre: '2do grado primaria', etapa: 'Primaria' },
                { nombre: '1er año secundaria', etapa: 'Secundaria' },
                { nombre: '2do año secundaria', etapa: 'Secundaria' }
            ];
            
            let html = '';
            secciones.forEach(seccion => {
                const estudiantes = Math.floor(Math.random() * 40 + 25);
                const baseAsistencia = rangoAsistencia[0] + Math.random() * (rangoAsistencia[1] - rangoAsistencia[0]);
                const asistencia = Math.max(50, Math.min(100, baseAsistencia + (Math.random() - 0.5) * variabilidad));
                const asistentes = Math.floor((asistencia / 100) * estudiantes);
                
                let badgeClass = 'success';
                let status = 'Excelente';
                if (asistencia < 70) { badgeClass = 'danger'; status = 'Crítico'; }
                else if (asistencia < 80) { badgeClass = 'warning'; status = 'Regular'; }
                else if (asistencia < 90) { badgeClass = 'info'; status = 'Bueno'; }
                
                html += `
                    <tr>
                        <td><strong>${seccion.nombre}</strong></td>
                        <td><small class="text-muted">${seccion.etapa}</small></td>
                        <td>${estudiantes}</td>
                        <td>${asistentes}</td>
                        <td>${Math.floor(asistentes / Math.ceil((new Date(fechaFin) - new Date(fechaInicio)) / (1000 * 60 * 60 * 24)))}</td>
                        <td><span class="badge bg-${badgeClass}">${asistencia.toFixed(1)}%</span></td>
                        <td><span class="badge bg-${badgeClass}">${status}</span></td>
                    </tr>
                `;
            });
            
            $('#seccionesStatsTable').html(html);
        }

        function actualizarIndicadoresRendimiento() {
            // Simular conteo de secciones por rendimiento
            const excelentes = Math.floor(Math.random() * 5 + 3);
            const buenas = Math.floor(Math.random() * 6 + 4);
            const regulares = Math.floor(Math.random() * 4 + 2);
            const criticas = Math.floor(Math.random() * 3 + 1);
            
            $('#seccionesExcelentes').text(excelentes);
            $('#seccionesBuenas').text(buenas);
            $('#seccionesRegulares').text(regulares);
            $('#seccionesCriticas').text(criticas);
        }

        function crearGraficos() {
            // Destruir gráficos existentes si existen
            if (charts && Object.keys(charts).length > 0) {
                Object.values(charts).forEach(chart => {
                    if (chart && typeof chart.destroy === 'function') {
                        chart.destroy();
                    }
                });
                charts = {};
            }

            // Configuración común para gráficos
            const commonOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: { color: '#e0e0e0' }
                    }
                },
                scales: {
                    y: {
                        ticks: { color: '#e0e0e0' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#e0e0e0' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            };

            // Verificar que los elementos canvas existen antes de crear gráficos
            const genderCanvas = document.getElementById('genderChart');
            if (genderCanvas) {
                charts.gender = new Chart(genderCanvas, {
                    type: 'doughnut',
                    data: {
                        labels: ['Masculino', 'Femenino'],
                        datasets: [{
                            data: [Math.floor(Math.random() * 10 + 80), Math.floor(Math.random() * 10 + 80)],
                            backgroundColor: ['#4facfe', '#ff6b9d'],
                            borderWidth: 2,
                            borderColor: '#1a1a2e'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: '#e0e0e0' }
                            }
                        }
                    }
                });
            }

            // Gráfico por Sección
            const sectionCanvas = document.getElementById('sectionChart');
            if (sectionCanvas) {
                const secciones = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];
                charts.section = new Chart(sectionCanvas, {
                    type: 'bar',
                    data: {
                        labels: secciones,
                        datasets: [{
                            label: 'Asistencia %',
                            data: secciones.map(() => Math.floor(Math.random() * 20 + 75)),
                            backgroundColor: '#667eea',
                            borderWidth: 1
                        }]
                    },
                    options: commonOptions
                });
            }

            // Gráfico por Etapa
            const stageCanvas = document.getElementById('stageChart');
            if (stageCanvas) {
                charts.stage = new Chart(stageCanvas, {
                    type: 'bar',
                    data: {
                        labels: ['Inicial', 'Primaria', 'Secundaria'],
                        datasets: [{
                            label: 'Asistencia %',
                            data: [Math.floor(Math.random() * 15 + 80), Math.floor(Math.random() * 15 + 80), Math.floor(Math.random() * 15 + 80)],
                            backgroundColor: ['#667eea', '#764ba2', '#4facfe'],
                            borderWidth: 1
                        }]
                    },
                    options: commonOptions
                });
            }

            // Gráfico de Tendencia Temporal
            const timeCanvas = document.getElementById('timeChart');
            if (timeCanvas) {
                const labels = currentPeriod === 'daily' ? 
                    ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'] :
                    currentPeriod === 'weekly' ? 
                    ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'] :
                    ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'];

                charts.time = new Chart(timeCanvas, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Asistencia %',
                            data: labels.map(() => Math.floor(Math.random() * 20 + 75)),
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: commonOptions
                });
            }

            // Gráfico Género por Etapa
            const genderStageCanvas = document.getElementById('genderStageChart');
            if (genderStageCanvas) {
                charts.genderStage = new Chart(genderStageCanvas, {
                    type: 'bar',
                    data: {
                        labels: ['Inicial', 'Primaria', 'Secundaria'],
                        datasets: [{
                            label: 'Masculino',
                            data: [Math.floor(Math.random() * 15 + 80), Math.floor(Math.random() * 15 + 80), Math.floor(Math.random() * 15 + 80)],
                            backgroundColor: '#4facfe'
                        }, {
                            label: 'Femenino',
                            data: [Math.floor(Math.random() * 15 + 80), Math.floor(Math.random() * 15 + 80), Math.floor(Math.random() * 15 + 80)],
                            backgroundColor: '#ff6b9d'
                        }]
                    },
                    options: commonOptions
                });
            }

            // Gráfico Ranking de Secciones
            const rankingCanvas = document.getElementById('rankingChart');
            if (rankingCanvas) {
                const seccionesRanking = ['A', 'B', 'C', 'D', 'E'];
                const datosRanking = seccionesRanking.map(() => Math.floor(Math.random() * 20 + 75)).sort((a, b) => b - a);
                
                charts.ranking = new Chart(rankingCanvas, {
                    type: 'bar',
                    data: {
                        labels: seccionesRanking,
                        datasets: [{
                            label: 'Asistencia %',
                            data: datosRanking,
                            backgroundColor: '#764ba2',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        ...commonOptions
                    }
                });
            }
        }

        function mostrarAlerta(mensaje, tipo) {
            const alerta = `
                <div class="alert alert-${tipo} alert-dismissible fade show" role="alert" style="margin: 30px;">
                    <i class="fas fa-info-circle"></i> ${mensaje}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" style="filter: invert(1);"></button>
                </div>
            `;
            $('#alertas').html(alerta);
            
            setTimeout(function() {
                $('.alert').fadeOut();
            }, 5000);
        }
    </script>
</body>
</html>
